<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Limitless</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --primary-color: #4285F4;
      --secondary-color: #34A853;
      --accent-color: #EA4335;
      --background-dark: #121212;
      --background-light: #1E1E1E;
      --text-color: #E0E0E0;
      --text-dark: #333;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      background-color: var(--background-dark);
      color: var(--text-color);
      font-family: 'Orbitron', sans-serif;
      overflow-x: hidden;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    #tabsBar {
      display: flex;
      gap: 5px;
      padding: 10px;
      background-color: var(--background-light);
      border-bottom: 2px solid var(--primary-color);
      flex-wrap: wrap;
      align-items: center;
      min-height: 50px;
    }

    .tabBtn {
      background-color: var(--background-light);
      color: var(--text-color);
      border: 1px solid var(--primary-color);
      padding: 5px 15px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      border-radius: 4px;
      max-width: 200px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .tabBtn:hover {
      background-color: #2a2a2a;
    }

    .activeTab {
      background-color: var(--primary-color) !important;
      color: white !important;
    }

    .tabCloseBtn {
      background: none;
      border: none;
      color: inherit;
      cursor: pointer;
      padding: 0;
      margin-left: 5px;
      font-size: 14px;
    }

    .tabCloseBtn:hover {
      color: var(--accent-color);
    }

    button {
      padding: 8px 16px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-family: 'Orbitron', sans-serif;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #3367d6;
    }

    button.secondary {
      background-color: var(--background-light);
      color: var(--text-color);
      border: 1px solid var(--primary-color);
    }

    button.secondary:hover {
      background-color: #2a2a2a;
    }

    input {
      padding: 10px 15px;
      width: 100%;
      max-width: 600px;
      font-size: 16px;
      border: 1px solid var(--primary-color);
      background: var(--background-light);
      color: var(--text-color);
      border-radius: 24px;
      outline: none;
      transition: all 0.3s;
    }

    input:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 2px rgba(66, 133, 244, 0.2);
    }

    #contentArea {
      flex: 1;
      position: relative;
      overflow: hidden;
    }

    .tabContent {
      display: none;
      height: 100%;
      width: 100%;
      position: absolute;
      top: 0;
      left: 0;
    }

    .visible {
      display: block;
    }

    .homeView {
      text-align: center;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
      background: linear-gradient(135deg, var(--background-dark) 0%, #1a1a2e 100%);
    }

    .title {
      font-size: 3rem;
      margin-bottom: 30px;
      background: linear-gradient(to right, var(--primary-color), var(--secondary-color), var(--accent-color));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
    }

    .searchContainer {
      display: flex;
      gap: 10px;
      width: 100%;
      max-width: 700px;
      z-index: 2;
    }

    iframe {
      width: 100%;
      height: calc(100% - 50px);
      border: none;
      background-color: white;
    }

    .controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      padding: 10px;
      background-color: var(--background-light);
      border-top: 1px solid var(--primary-color);
      height: 50px;
    }

    .urlBar {
      flex: 1;
      max-width: 800px;
      margin: 0 10px;
    }

    .loadingText {
      font-size: 24px;
      text-align: center;
      animation: pulse 1s infinite alternate;
      color: var(--primary-color);
      margin: 20px;
    }

    .addTabBtn {
      margin-left: auto;
      background-color: var(--secondary-color);
    }

    .addTabBtn:hover {
      background-color: #2d9141;
    }

    @keyframes pulse {
      from { opacity: 0.5; }
      to   { opacity: 1; }
    }

    @media (max-width: 768px) {
      .title {
        font-size: 2rem;
      }
      
      .searchContainer {
        flex-direction: column;
      }
      
      input, button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div id="tabsBar"></div>
  <div id="contentArea"></div>

  
    <script src="/active/uv/uv.bundle.js"></script>
    <script src="/active/uv/uv.config.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      let tabs = [];
      let activeTab = null;
      const defaultTitle = "New Tab";

      newTab();

      function newTab(title = defaultTitle, url = "") {
        const id = `tab${Date.now()}`;
        const tab = { 
          id, 
          title: title || defaultTitle, 
          url: url || "", 
          state: url ? "browsing" : "home",
          canGoBack: false,
          canGoForward: false
        };
        
        tabs.push(tab);
        renderTabs();
        
        if (url) {
          createBrowserContent(tab);
        } else {
          createHomeContent(tab);
        }
        
        switchTab(id);
      }

      function renderTabs() {
        const tabsBar = document.getElementById("tabsBar");
        tabsBar.innerHTML = "";

        tabs.forEach(tab => {
          const tabBtn = document.createElement("div");
          tabBtn.className = "tabBtn";
          if (tab.id === activeTab) tabBtn.classList.add("activeTab");

          const titleSpan = document.createElement("span");
          titleSpan.textContent = tab.title.length > 20 
            ? `${tab.title.substring(0, 17)}...` 
            : tab.title;
          titleSpan.onclick = () => switchTab(tab.id);

          const closeBtn = document.createElement("button");
          closeBtn.className = "tabCloseBtn";
          closeBtn.textContent = "âœ–";
          closeBtn.onclick = (e) => {
            e.stopPropagation();
            closeTab(tab.id);
          };

          tabBtn.appendChild(titleSpan);
          tabBtn.appendChild(closeBtn);
          tabsBar.appendChild(tabBtn);
        });

        const addBtn = document.createElement("button");
        addBtn.className = "addTabBtn";
        addBtn.textContent = "+";
        addBtn.title = "New Tab";
        addBtn.onclick = () => newTab();
        tabsBar.appendChild(addBtn);
      }

      function switchTab(id) {
        if (activeTab === id) return;
        
        activeTab = id;
        document.querySelectorAll(".tabContent").forEach(div => {
          div.classList.remove("visible");
        });
        
        const tabContent = document.getElementById(id);
        if (tabContent) {
          tabContent.classList.add("visible");
          
          if (tabs.find(t => t.id === id)?.state === "browsing") {
            updateNavButtons(id);
          }
        }
        
        renderTabs();
      }

      function closeTab(id) {
        if (tabs.length <= 1) {

          const tab = tabs.find(t => t.id === id);
          if (tab) {
            tab.url = "";
            tab.title = defaultTitle;
            tab.state = "home";
            document.getElementById(id)?.remove();
            createHomeContent(tab);
            switchTab(id);
          }
          return;
        }
        
        const tabIndex = tabs.findIndex(t => t.id === id);
        document.getElementById(id)?.remove();
        tabs = tabs.filter(t => t.id !== id);
        
        if (tabs.length > 0) {
          const newActiveIndex = Math.min(tabIndex, tabs.length - 1);
          switchTab(tabs[newActiveIndex].id);
        }
      }

      function createHomeContent(tab) {
        const contentArea = document.getElementById("contentArea");
        const wrapper = document.createElement("div");
        wrapper.className = "tabContent";
        wrapper.id = tab.id;

        const homeView = document.createElement("div");
        homeView.className = "homeView";

        const title = document.createElement("h1");
        title.className = "title";
        title.textContent = "Limitless Browser";
        homeView.appendChild(title);

        const searchContainer = document.createElement("div");
        searchContainer.className = "searchContainer";

        const searchInput = document.createElement("input");
        searchInput.type = "text";
        searchInput.placeholder = "Search with Google or enter URL...";
        searchInput.className = "searchBox";
        searchInput.addEventListener("keypress", e => {
          if (e.key === "Enter") navigate(tab.id, searchInput.value);
        });

        const searchButton = document.createElement("button");
        searchButton.textContent = "Search";
        searchButton.onclick = () => navigate(tab.id, searchInput.value);

        searchContainer.appendChild(searchInput);
        searchContainer.appendChild(searchButton);
        homeView.appendChild(searchContainer);
        wrapper.appendChild(homeView);
        contentArea.appendChild(wrapper);
      }

      function createBrowserContent(tab) {
        const contentArea = document.getElementById("contentArea");
        
        const existingContent = document.getElementById(tab.id);
        if (existingContent) existingContent.remove();

        const wrapper = document.createElement("div");
        wrapper.className = "tabContent";
        wrapper.id = tab.id;

        const loadingMsg = document.createElement("div");
        loadingMsg.className = "loadingText";
        loadingMsg.textContent = "Loading...";
        wrapper.appendChild(loadingMsg);

        const iframe = document.createElement("iframe");
        iframe.src = tab.url;
        iframe.id = `browserFrame-${tab.id}`;
        iframe.setAttribute("sandbox", "allow-scripts allow-forms allow-same-origin allow-popups allow-modals");
        iframe.addEventListener("load", () => {
          loadingMsg.remove();
          updateTabTitle(tab.id, iframe.contentDocument?.title || tab.url);
          updateNavButtons(tab.id);
        });
        wrapper.appendChild(iframe);

        const controls = document.createElement("div");
        controls.className = "controls";

        const backBtn = document.createElement("button");
        backBtn.className = "secondary";
        backBtn.innerHTML = "&larr;";
        backBtn.title = "Back";
        backBtn.onclick = () => goBack(tab.id);

        const forwardBtn = document.createElement("button");
        forwardBtn.className = "secondary";
        forwardBtn.innerHTML = "&rarr;";
        forwardBtn.title = "Forward";
        forwardBtn.onclick = () => goForward(tab.id);

        const reloadBtn = document.createElement("button");
        reloadBtn.className = "secondary";
        reloadBtn.innerHTML = "&olarr;";
        reloadBtn.title = "Reload";
        reloadBtn.onclick = () => reload(tab.id);

        const homeBtn = document.createElement("button");
        homeBtn.className = "secondary";
        homeBtn.innerHTML = "âŒ‚";
        homeBtn.title = "Home";
        homeBtn.onclick = () => {
          const tab = tabs.find(t => t.id === tab.id);
          if (tab) {
            tab.url = "";
            tab.state = "home";
            document.getElementById(tab.id)?.remove();
            createHomeContent(tab);
            switchTab(tab.id);
          }
        };

        const urlInput = document.createElement("input");
        urlInput.className = "urlBar";
        urlInput.type = "text";
        urlInput.value = tab.url;
        urlInput.addEventListener("keypress", e => {
          if (e.key === "Enter") navigate(tab.id, urlInput.value);
        });

        controls.appendChild(backBtn);
        controls.appendChild(forwardBtn);
        controls.appendChild(reloadBtn);
        controls.appendChild(homeBtn);
        controls.appendChild(urlInput);
        wrapper.appendChild(controls);
        contentArea.appendChild(wrapper);
      }

      function navigate(tabId, query) {
        if (!query) return;
        
        const tab = tabs.find(t => t.id === tabId);
        if (!tab) return;
        
        let url;
        

        try {
          new URL(query);
          url = query;
        } catch (e) {

          url = `https://www.google.com/search?q=${encodeURIComponent(query)}`;
        }
        
        if (!url.startsWith('http://') && !url.startsWith('https://')) {
          url = 'https://' + url;
        }
        
        tab.url = url;
        tab.title = query;
        tab.state = "browsing";
        
        document.getElementById(tabId)?.remove();
        createBrowserContent(tab);
        renderTabs();
      }

      function updateTabTitle(tabId, title) {
        const tab = tabs.find(t => t.id === tabId);
        if (tab) {
          tab.title = title || tab.url || defaultTitle;
          renderTabs();
        }
      }

      function updateNavButtons(tabId) {
        const tab = tabs.find(t => t.id === tabId);
        if (!tab || tab.state !== "browsing") return;
        
        const iframe = document.getElementById(`browserFrame-${tabId}`);
        if (!iframe || !iframe.contentWindow) return;
        
        try {
          tab.canGoBack = iframe.contentWindow.history.length > 1 && 
                         !iframe.contentWindow.history.state?.initial;
          tab.canGoForward = iframe.contentWindow.history.state?.forward;
        } catch (e) {
          tab.canGoBack = false;
          tab.canGoForward = false;
        }
        
        const controls = document.querySelector(`#${tabId} .controls`);
        if (controls) {
          const backBtn = controls.querySelector("button:nth-child(1)");
          const forwardBtn = controls.querySelector("button:nth-child(2)");
          
          if (backBtn) backBtn.disabled = !tab.canGoBack;
          if (forwardBtn) forwardBtn.disabled = !tab.canGoForward;
        }
      }

      function getIframe(tabId) {
        return document.getElementById(`browserFrame-${tabId}`);
      }

      function goBack(tabId) {
        const tab = tabs.find(t => t.id === tabId);
        if (!tab || !tab.canGoBack) return;
        
        const iframe = getIframe(tabId);
        if (iframe?.contentWindow) {
          iframe.contentWindow.history.back();
          
          setTimeout(() => updateNavButtons(tabId), 100);
        }
      }

      function goForward(tabId) {
        const tab = tabs.find(t => t.id === tabId);
        if (!tab || !tab.canGoForward) return;
        
        const iframe = getIframe(tabId);
        if (iframe?.contentWindow) {
          iframe.contentWindow.history.forward();
          
          setTimeout(() => updateNavButtons(tabId), 100);
        }
      }

      function reload(tabId) {
        const iframe = getIframe(tabId);
        if (iframe?.contentWindow) {
          const loadingMsg = document.createElement("div");
          loadingMsg.className = "loadingText";
          loadingMsg.textContent = "Loading...";
          iframe.parentNode.insertBefore(loadingMsg, iframe);
          
          iframe.contentWindow.location.reload();
          
          iframe.onload = () => {
            loadingMsg.remove();
            updateNavButtons(tabId);
          };
        }
      }

      window.goBack = goBack;
      window.goForward = goForward;
      window.reload = reload;
    });
  </script>
</body>
</html>
